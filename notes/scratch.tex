\documentclass{article}

\usepackage[margin=0.8in]{geometry}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{mathpartir}

\begin{document}

\subsection{Syntax}
\begin{align*}
  & Ar && ::= s_k \mid (x :_U M) \rightarrow Ar \\
  & Pos && ::= X \overrightarrow{m} \mid (x :_s M) \rightarrow Pos \mid (x :_s M) \multimap Pos \\
  & Co_U && ::= X \overrightarrow{m} \mid (\_ :_U P) \rightarrow Co'_U \mid (x :_U M) \rightarrow Co'_U \\
  & Co'_U && ::= X \overrightarrow{m} \mid (\_ :_U P) \multimap Co'_U \mid (x :_U M) \multimap Co'_U \\
  & Co_L && ::= X \overrightarrow{m} \mid (\_ :_s P) \rightarrow Co'_L \mid (x :_U M) \rightarrow Co'_L \mid  (\_ :_L M) \rightarrow Co'_L \\
  & Co'_L && ::= X \overrightarrow{m} \mid (\_ :_s P) \multimap Co'_L \mid (x :_U M) \multimap Co'_L \mid (\_ :_L M) \multimap Co'_L
\end{align*}

\subsection{Introduction Rules}

\begin{mathpar}
\inferrule
  { (\forall i = 1 ... n) \\ arity(A, s_k) \\ constructor_s(C_i, X) \\\\
    |\Gamma| \\  \Gamma \vdash A : U_{k+1} \\ \Gamma, X :_U A \vdash C_i : U_k }
  { \Gamma \vdash Ind_s(X : A)\{C_1|...|C_n\} : A }

  \inferrule
  { |\Gamma| \\ \Gamma \vdash Ind_s(X : A)\{C_1|...|C_n\} : A \\ 1 \leq i \leq n }
  { \Gamma \vdash Constr(i, I_s) : C_i[I_s/X] }
\end{mathpar}

\subsection{Non-Dependent Elimination}

\begin{align*}
  & ((x :_{s'} M) \rightarrow P) \{s\} && = U \\
  & ((x :_{s'} M) \multimap P) \{s\} && = L \\
  & (X\ \overrightarrow{m}) \{s\} && = s
\end{align*}

\begin{align*}
  & ((\_ :_U P) \rightarrow C)\{X,Q,s\} && = (\_ :_U P) \rightarrow (\_ :_{s'} P[Q/X]) \multimap C\{X,Q,s\} &&& (where\ s' = P\{s\}) \\
  & ((\_ :_U P) \multimap C)\{X,Q,s\} && = (\_ :_U P) \multimap (\_ :_{s'} P[Q/X]) \multimap C\{X,Q,s\} &&& (where\ s' = P\{s\}) \\
  & ((\_ :_L P) \rightarrow C)\{X,Q,s\} && = (\_ :_{s'} P[Q/X]) \rightarrow C\{X,Q,s\} &&& (where\ s' = P\{s\}) \\
  & ((\_ :_L P) \multimap C)\{X,Q,s\} && = (\_ :_{s'} P[Q/X]) \multimap C\{X,Q,s\} &&& (where\ s' = P\{s\}) \\
  & ((x :_s M) \rightarrow C)\{X,Q,s\} && = (x :_s M) \rightarrow C\{X,Q,s\} &&& \\
  & ((x :_s M) \multimap C)\{X,Q,s\} && = (x :_s M) \multimap C\{X,Q,s\} &&& \\
  & (X\ \overrightarrow{m})\{X,Q,s\} && = Q\ \overrightarrow{m} &&&
\end{align*}

\begin{align*}
  & ((\_ :_s P) \rightarrow C)\{X,Q\} && = (\_ :_s P) \multimap C\{X,Q\} \\
  & ((\_ :_s P) \multimap C)\{X,Q\} && = (\_ :_s P) \multimap C\{X,Q\} \\
  & ((x :_s M) \rightarrow C)\{X,Q\} && = (x :_s M) \multimap C\{X,Q\} \\
  & ((x :_s M) \multimap C)\{X,Q\} && = (x :_s M) \multimap C\{X,Q\} \\
  & (X\ \overrightarrow{m})\{X,Q\} && = Q\ \overrightarrow{m}
\end{align*}

\begin{mathpar}
  \inferrule
  { (\forall i = \ 1...n) \\ |\Gamma_2| \\ \Gamma_1 \ddagger \Gamma_2 \ddagger \Gamma \\\\
    \Gamma_1 \vdash c : (I_s\ \overrightarrow{a}) \\
    \Gamma_2 \vdash Q : (\overrightarrow{x} :_U \overrightarrow{A}) \rightarrow s' \\
    \Gamma_2 \vdash f_i : C_i\{I_s,Q,s'\} }
  { \Gamma \vdash Rec(c,Q)\{f_1|...|f_n\} : (Q \overrightarrow{a}) }

  \inferrule
  { (\forall i = \ 1...n) \\ \Gamma_1 \ddagger \Gamma_2 \ddagger \Gamma \\\\
    \Gamma_1 \vdash c : (I_s\ \overrightarrow{a}) \\
    \overline{\Gamma_2} \vdash Q : (\overrightarrow{x} :_U \overrightarrow{A}) \rightarrow s' \\
    \Gamma_2 \vdash f_i : C_i\{I_s,Q\} }
  { \Gamma \vdash Elim(c,Q)\{f_1|...|f_n\} : (Q \overrightarrow{a}) }
\end{mathpar}


\subsection{Dependent Elimination}

\begin{align*}
  & ((x :_s M) \rightarrow P)\{Q,p\} && = (x :_s M) \rightarrow P\{Q,(p\ x)\} \\
  & ((x :_s M) \multimap P)\{Q,p\} && = (x :_s M) \multimap P\{Q,(p\ x)\} \\
  & (X\ \overrightarrow{m})\{Q,p\} && = Q\ \overrightarrow{m}\ p
\end{align*}

\begin{align*}
  & ((\_ :_U P) \rightarrow C)\{X,Q,s,c\} && = (p :_U P) \rightarrow (\_ :_{s'} P\{Q,p\}) \multimap C\{X,Q,s,(c\ p)\} &&& (where\ s' = P\{s\}) \\
  & ((\_ :_U P) \multimap C)\{X,Q,s,c\} && = (p :_U P) \multimap (\_ :_{s'} P\{Q,p\}) \multimap C\{X,Q,s,(c\ p)\} &&& (where\ s' = P\{s\})\\
  & ((x :_U M) \rightarrow C)\{X,Q,s,c\} && = (x :_U M) \rightarrow C\{X,Q,s,(c\ x)\} \\
  & ((x :_U M) \multimap C)\{X,Q,s,c\} && = (x :_U M) \multimap C\{X,Q,s,(c\ x)\} \\
  & (X\ \overrightarrow{m})\{X,Q,s,c\} && = (Q\ \overrightarrow{m}\ c)
\end{align*}

\begin{align*}
  & ((\_ :_U P) \rightarrow C)\{X,Q,c\} && = (p :_U P) \multimap C\{X,Q,(c\ p)\} \\
  & ((\_ :_U P) \multimap C)\{X,Q,c\} && = (p :_U P) \multimap C\{X,Q,(c\ p)\} \\
  & ((x :_U P) \rightarrow C)\{X,Q,c\} && = (x :_U M) \multimap C\{X,Q,(c\ x)\} \\
  & ((x :_U P) \multimap C)\{X,Q,c\} && = (x :_U M) \multimap C\{X,Q,(c\ x)\} \\
  & (X\ \overrightarrow{m})\{X,Q,c\} && = (Q\ \overrightarrow{m}\ c)
\end{align*}

\begin{mathpar}
  \inferrule
  { (\forall i = 1 ... n) \\ |\Gamma_2| \\ \Gamma_1 \ddagger \Gamma_2 \ddagger \Gamma \\\\
    \Gamma_1 \vdash c : (I_U\ \overrightarrow{a}) \\
    \Gamma_2 \vdash Q : (\overrightarrow{x} :_U \overrightarrow{A}) \rightarrow (\_ :_U I_U\ \overrightarrow{x}) \rightarrow s' \\
    \Gamma_2 \vdash f_i : C_i\{I_U,Q,s',Constr(i,I_U)\} }
  { \Gamma \vdash Rec(c,Q)\{f_1|...|f_n\} : (Q\ \overrightarrow{a}\ c) }

  \inferrule
  { (\forall i = 1 ... n) \\ \Gamma_1 \ddagger \Gamma_2 \ddagger \Gamma \\\\
    \Gamma_1 \vdash c : (I_U\ \overrightarrow{a}) \\
    \overline{\Gamma_2} \vdash Q : (\overrightarrow{x} :_U \overrightarrow{A}) \rightarrow (\_ :_U I_U\ \overrightarrow{x}) \rightarrow s' \\
    \Gamma_2 \vdash f_i : C_i\{I_U,Q,Constr(i,I_U)\} }
  { \Gamma \vdash Elim(c,Q)\{f_1|...|f_n\} : (Q\ \overrightarrow{a}\ c) }
\end{mathpar}

\subsection{Conversion}

\begin{align*}
  & ((\_ :_U P) \rightarrow C)[X,F,f] && = \lambda p.C[X,F,(f\ p\ \lambda \overrightarrow{x}.(F\ \overrightarrow{m}\ (p\ \overrightarrow{x})))] \\
  & ((\_ :_U P) \multimap C)[X,F,f] && = \lambda p.C[X,F,(f\ p\ \lambda \overrightarrow{x}.(F\ \overrightarrow{m}\ (p\ \overrightarrow{x})))] \\
  & ((\_ :_L P) \rightarrow C)[X,F,f] && = \lambda p.C[X,F,(f\ \lambda \overrightarrow{x}.(F\ \overrightarrow{m}\ (p\ \overrightarrow{x})))] \\
  & ((\_ :_L P) \multimap C)[X,F,f] && = \lambda p.C[X,F,(f\ \lambda \overrightarrow{x}.(F\ \overrightarrow{m}\ (p\ \overrightarrow{x})))] \\
  & ((x :_s M) \rightarrow C)[X,F,f] && = \lambda x.C[X,F,(f\ x)] \\
  & ((x :_s M) \multimap C)[X,F,f] && = \lambda x.C[X,F,(f\ x)] \\
  & (X\ \overrightarrow{m})[X,F,f] && = f
\end{align*}

\begin{align*}
  & ((\_ :_s P) \rightarrow C)[X,f] && = \lambda p.C[X,(f\ p)] \\
  & ((\_ :_s P) \multimap C)[X,f] && = \lambda p.C[X,(f\ p)] \\
  & ((x :_s M) \rightarrow C)[X,f] && = \lambda x.C[X,(f\ x)] \\
  & ((x :_s M) \multimap C)[X,f] && = \lambda x.C[X,(f\ x)] \\
  & (X\ \overrightarrow{m})[X,f] && = f
\end{align*}

\begin{align*}
  Fun\_Rec(I_s,Q,\overrightarrow{f}) = \lambda \overrightarrow{x}. \lambda c.Rec(c,Q)\{\overrightarrow{f}\}
\end{align*}

\begin{align*}
  & Rec((Constr(i, I_s)\ \overrightarrow{m}), Q)\{\overrightarrow{f}\} && \rightarrow_\iota && (C_i[I_s,Fun\_Rec(I_s,Q,\overrightarrow{f}),f_i]\ \overrightarrow{m}) \\
  & Elim((Constr(i, I_s)\ \overrightarrow{m}), Q)\{\overrightarrow{f}\} && \rightarrow_\iota && (C_i[I_s,f_i]\ \overrightarrow{m})
\end{align*}

\end{document}